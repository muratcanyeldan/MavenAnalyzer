package com.muratcan.yeldan.mavenanalyzer.service;

import com.muratcan.yeldan.mavenanalyzer.entity.DependencyAnalysis;

public interface VulnerabilityService {

    /**
     * Manually clear the cache for a specific dependency
     *
     * @param groupId    The Maven group ID
     * @param artifactId The Maven artifact ID
     * @param version    The version of the dependency
     */
    void clearVulnerabilityCache(String groupId, String artifactId, String version);

    void clearAllVulnerabilityCaches();

    /**
     * Process all dependencies for an analysis in batches and check for vulnerabilities
     * This is more efficient than checking each dependency individually
     *
     * @param analysisId The ID of the analysis to process
     */
    void processDependenciesInBatches(Long analysisId);

    DependencyAnalysis getAnalysisWithFreshTransaction(Long analysisId);
} 
{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{Typography,Paper,Box,Grid,Tabs,Tab,Card,CardContent,Divider,CircularProgress,Button,IconButton,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Chip,Tooltip,TextField,InputAdornment}from'@mui/material';import ArrowBackIcon from'@mui/icons-material/ArrowBack';import DownloadIcon from'@mui/icons-material/Download';import ShareIcon from'@mui/icons-material/Share';import SearchIcon from'@mui/icons-material/Search';import WarningIcon from'@mui/icons-material/Warning';import CheckCircleIcon from'@mui/icons-material/CheckCircle';import UpdateIcon from'@mui/icons-material/Update';import InfoIcon from'@mui/icons-material/Info';import LockIcon from'@mui/icons-material/Lock';import api from'../services/api';// Sample chart component (to be replaced with a real chart library)\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const SampleChart=_ref=>{let{title,type}=_ref;return/*#__PURE__*/_jsxs(Box,{sx:{height:250,bgcolor:'rgba(33, 150, 243, 0.1)',borderRadius:1,display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column',p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:title}),/*#__PURE__*/_jsxs(Typography,{color:\"text.secondary\",children:[type,\" Chart\"]})]});};// Tab panel component for tab content\nfunction TabPanel(props){const{children,value,index,...other}=props;return/*#__PURE__*/_jsx(\"div\",{role:\"tabpanel\",hidden:value!==index,id:`analysis-tabpanel-${index}`,\"aria-labelledby\":`analysis-tab-${index}`,...other,children:value===index&&/*#__PURE__*/_jsx(Box,{sx:{p:3},children:children})});}const AnalysisDetail=()=>{const{id:analysisId}=useParams();const navigate=useNavigate();const[loading,setLoading]=useState(true);const[analysis,setAnalysis]=useState(null);const[tabValue,setTabValue]=useState(0);const[searchQuery,setSearchQuery]=useState('');const[dependencies,setDependencies]=useState([]);const[error,setError]=useState(null);useEffect(()=>{// Fetch actual analysis data from the API\nconst fetchAnalysisData=async()=>{setLoading(true);try{// Get analysis details\nconst response=await api.dependencyAnalysis.getById(analysisId);console.log('Analysis data:',response.data);// Calculate total vulnerabilities for the header stats\nconst totalVulnerabilities=response.data.dependencies?response.data.dependencies.reduce((total,dep)=>total+(dep.vulnerableCount||0),0):0;// Combine the analysis data with calculated values\nsetAnalysis({...response.data,vulnerableCount:totalVulnerabilities});// If the analysis contains dependencies, set them\nif(response.data.dependencies){setDependencies(response.data.dependencies);}}catch(error){console.error('Error fetching analysis:',error);setError('Failed to load analysis data. Please try again.');// Set mock data for development/fallback\nconst mockAnalysis={id:parseInt(analysisId),projectId:1,projectName:'Error Loading Project',date:new Date().toISOString().split('T')[0],status:'error',totalDependencies:0,outdatedDependencies:0,vulnerabilities:0,licenseIssues:0};setAnalysis(mockAnalysis);setDependencies([]);}finally{setLoading(false);}};fetchAnalysisData();},[analysisId]);const handleTabChange=(event,newValue)=>{setTabValue(newValue);};// Filtering dependencies based on search query\nconst filteredDependencies=dependencies.filter(dep=>{const fullName=`${dep.groupId}:${dep.artifactId}:${dep.currentVersion}`.toLowerCase();return fullName.includes(searchQuery.toLowerCase());});// Collecting all vulnerabilities from dependencies for the vulnerabilities tab\nconst allVulnerabilities=React.useMemo(()=>{const vulnerabilities=[];dependencies.forEach(dep=>{if(dep.vulnerabilities&&dep.vulnerabilities.length>0){dep.vulnerabilities.forEach(vuln=>{vulnerabilities.push({...vuln,dependency:`${dep.groupId}:${dep.artifactId}:${dep.currentVersion}`});});}});return vulnerabilities;},[dependencies]);if(loading){return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',mt:10},children:/*#__PURE__*/_jsx(CircularProgress,{})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:3},children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>navigate(-1),sx:{mr:1},children:/*#__PURE__*/_jsx(ArrowBackIcon,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",sx:{flexGrow:1},children:\"Analysis Details\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(DownloadIcon,{}),sx:{mr:1},children:\"Export\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(ShareIcon,{}),children:\"Share\"})]}),/*#__PURE__*/_jsx(Paper,{sx:{p:3,mb:4},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:8,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"Project: \",analysis.projectName]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"Analysis completed on \",analysis.date]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,sx:{display:'flex',justifyContent:{xs:'flex-start',md:'flex-end'}},children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Chip,{label:analysis.status==='completed'?'Completed':'In Progress',color:analysis.status==='completed'?'success':'primary',sx:{mb:1}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"ID: \",analysis.id]})]})})]})}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mb:4},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(33, 150, 243, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"Total Dependencies\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1},children:analysis.totalDependencies})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(255, 152, 0, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"Outdated\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1,color:'warning.main'},children:analysis.outdatedDependencies})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(239, 83, 80, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"Vulnerabilities\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1,color:'error.main'},children:analysis.vulnerableCount||0})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(156, 39, 176, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"License Issues\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1,color:'#9c27b0'},children:analysis.licenseIssues})]})})]}),/*#__PURE__*/_jsxs(Paper,{sx:{mb:4},children:[/*#__PURE__*/_jsx(Box,{sx:{borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsxs(Tabs,{value:tabValue,onChange:handleTabChange,\"aria-label\":\"analysis tabs\",variant:\"scrollable\",scrollButtons:\"auto\",children:[/*#__PURE__*/_jsx(Tab,{label:\"Overview\"}),/*#__PURE__*/_jsx(Tab,{label:\"Dependencies\"}),/*#__PURE__*/_jsx(Tab,{label:\"Charts\"}),/*#__PURE__*/_jsx(Tab,{label:\"Vulnerabilities\"}),/*#__PURE__*/_jsx(Tab,{label:\"Licenses\"})]})}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:0,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Analysis Overview\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(SampleChart,{title:\"Dependency Status\",type:\"Pie\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(SampleChart,{title:\"Security Overview\",type:\"Bar\"})})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,sx:{mt:4},children:\"Summary\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",paragraph:true,children:[\"This analysis found \",analysis.outdatedDependencies,\" outdated dependencies, \",analysis.vulnerableCount||0,\" security vulnerabilities, and \",analysis.licenseIssues,\" license compliance issues.\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",paragraph:true,children:\"It's recommended to update the dependencies to their latest versions to resolve security issues and take advantage of the latest features and bug fixes.\"}),/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",children:\"Generate Full Report\"})})]}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:1,children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"Dependencies (\",filteredDependencies.length,\")\"]}),/*#__PURE__*/_jsx(TextField,{placeholder:\"Search dependencies...\",size:\"small\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(SearchIcon,{})})}})]}),/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Group ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Artifact ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Current Version\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Latest Version\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Scope\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{children:\"License\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:filteredDependencies.map(dep=>/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:dep.groupId}),/*#__PURE__*/_jsx(TableCell,{children:dep.artifactId}),/*#__PURE__*/_jsx(TableCell,{children:dep.currentVersion}),/*#__PURE__*/_jsxs(TableCell,{children:[dep.latestVersion,dep.latestVersion!==dep.currentVersion&&!dep.currentVersion.includes('MANAGED_BY_BOM')&&/*#__PURE__*/_jsx(Chip,{label:\"Update\",size:\"small\",color:\"primary\",variant:\"outlined\",sx:{ml:1}})]}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:dep.scope,size:\"small\",variant:\"outlined\"})}),/*#__PURE__*/_jsxs(TableCell,{children:[dep.isOutdated?/*#__PURE__*/_jsx(Tooltip,{title:\"Outdated\",children:/*#__PURE__*/_jsx(UpdateIcon,{color:\"warning\",fontSize:\"small\"})}):/*#__PURE__*/_jsx(Tooltip,{title:\"Up to date\",children:/*#__PURE__*/_jsx(CheckCircleIcon,{color:\"success\",fontSize:\"small\"})}),dep.isVulnerable&&/*#__PURE__*/_jsx(Tooltip,{title:`${dep.vulnerableCount} vulnerabilities found`,children:/*#__PURE__*/_jsx(WarningIcon,{color:\"error\",fontSize:\"small\",sx:{ml:1}})})]}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Tooltip,{title:dep.license,children:/*#__PURE__*/_jsx(Chip,{icon:/*#__PURE__*/_jsx(LockIcon,{fontSize:\"small\"}),label:dep.license,size:\"small\",variant:\"outlined\"})})})]},dep.id))})]})})]}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:2,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Visualization Charts\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(SampleChart,{title:\"Dependency Update Status\",type:\"Pie\"})})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(SampleChart,{title:\"Vulnerabilities by Severity\",type:\"Bar\"})})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(SampleChart,{title:\"License Distribution\",type:\"Donut\"})})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsx(SampleChart,{title:\"Dependencies by Scope\",type:\"Bar\"})})})})]})]}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:3,children:allVulnerabilities.length>0?/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Dependency\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Vulnerability\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Severity\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Description\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Affected Versions\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Fixed In\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:allVulnerabilities.map((vuln,index)=>/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:vuln.dependency}),/*#__PURE__*/_jsx(TableCell,{children:vuln.name}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:vuln.severity,color:vuln.severity==='CRITICAL'?'error':vuln.severity==='HIGH'?'error':vuln.severity==='MEDIUM'?'warning':'info',size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:vuln.description}),/*#__PURE__*/_jsx(TableCell,{children:vuln.affectedVersions}),/*#__PURE__*/_jsx(TableCell,{children:vuln.fixedInVersion})]},`${vuln.id||index}`))})]})}):/*#__PURE__*/_jsxs(Box,{sx:{p:4,textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"No vulnerabilities found\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:1},children:\"All dependencies appear to be secure. Continue to monitor for new vulnerabilities.\"})]})}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"License Compliance\"}),analysis.licenseIssues>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",paragraph:true,children:\"The following dependencies have license issues that may need attention:\"}),/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Dependency\"}),/*#__PURE__*/_jsx(TableCell,{children:\"License\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Issue\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Recommendation\"})]})}),/*#__PURE__*/_jsxs(TableBody,{children:[/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:\"mysql:mysql-connector-java:8.0.28\"}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:\"GPL\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:\"GPL is copyleft license and may be incompatible with commercial use\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Consider using a commercial license or alternative database connector\"})]}),/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:\"unknown:library:1.0.0\"}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:\"Unknown\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:\"No license information available\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Verify license information with the library author\"})]})]})]})})]}):/*#__PURE__*/_jsxs(Box,{sx:{p:4,textAlign:'center'},children:[/*#__PURE__*/_jsx(CheckCircleIcon,{color:\"success\",sx:{fontSize:48,mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"No license issues found\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"All your dependencies have compatible licenses.\"})]})]})]})]});};export default AnalysisDetail;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
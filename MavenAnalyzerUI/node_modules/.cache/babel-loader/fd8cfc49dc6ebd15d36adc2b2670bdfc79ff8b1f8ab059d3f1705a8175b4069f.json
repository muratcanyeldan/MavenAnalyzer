{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{useParams,useNavigate,useLocation}from'react-router-dom';import{useSnackbar}from'notistack';import{Typography,Paper,Box,Grid,Tabs,Tab,Card,CardContent,Divider,CircularProgress,Button,IconButton,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Chip,Tooltip,TextField,InputAdornment,Snackbar,Alert,List,ListItem,ListItemText,ListItemIcon,Switch,FormControlLabel}from'@mui/material';import{ArrowBack as ArrowBackIcon,Download as DownloadIcon,Share as ShareIcon,Search as SearchIcon,Warning as WarningIcon,CheckCircle as CheckCircleIcon,Update as UpdateIcon,Info as InfoIcon,Lock as LockIcon,MoreVert as MoreVertIcon,Timeline as TimelineIcon,ContentCopy as ContentCopyIcon}from'@mui/icons-material';import api from'../services/api';import{DependencyStatusChart,VulnerabilityChart,VulnerabilitySeverityChart,LicenseDistributionChart}from'../components/charts';import{formatDate}from'../utils/dateUtils';// Sample chart component (kept for backward compatibility with other tabs)\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const SampleChart=_ref=>{let{title,type}=_ref;return/*#__PURE__*/_jsxs(Box,{sx:{height:250,bgcolor:'rgba(33, 150, 243, 0.1)',borderRadius:1,display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column',p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:title}),/*#__PURE__*/_jsxs(Typography,{color:\"text.secondary\",children:[type,\" Chart\"]})]});};// Tab panel component for tab content\nfunction TabPanel(props){const{children,value,index,...other}=props;return/*#__PURE__*/_jsx(\"div\",{role:\"tabpanel\",hidden:value!==index,id:`analysis-tabpanel-${index}`,\"aria-labelledby\":`analysis-tab-${index}`,...other,children:value===index&&/*#__PURE__*/_jsx(Box,{sx:{p:3},children:children})});}const AnalysisDetail=()=>{const params=useParams();const analysisId=params.id;const navigate=useNavigate();const[loading,setLoading]=useState(true);const[vulnerabilitiesLoading,setVulnerabilitiesLoading]=useState(true);const[analysis,setAnalysis]=useState(null);const[tabValue,setTabValue]=useState(0);const[searchQuery,setSearchQuery]=useState('');const[dependencies,setDependencies]=useState([]);const[error,setError]=useState(null);const[snackbar,setSnackbar]=useState({open:false,message:'',severity:'info'});const[charts,setCharts]=useState({dependencyUpdates:null,vulnerabilities:null,licenses:null});const[chartsLoading,setChartsLoading]=useState(false);// Poll for vulnerability updates\nconst pollForVulnerabilityUpdates=async()=>{try{console.log(`Starting vulnerability polling for analysis ID: ${analysisId}`);// Set an interval to check for vulnerability updates\nconst intervalId=setInterval(async()=>{try{var _response$data$depend,_response$data$depend2,_response$data$depend3;// Use the specific vulnerability status endpoint for more efficient polling\nconsole.log(`Polling vulnerability status for analysis ID: ${analysisId}`);const response=await api.dependencyAnalysis.getVulnerabilityStatus(analysisId);console.log(`Received vulnerability status for analysis ID: ${analysisId}`,{status:response.data.vulnerabilityCheckStatus,dependencies:((_response$data$depend=response.data.dependencies)===null||_response$data$depend===void 0?void 0:_response$data$depend.length)||0});// Calculate the progress percentage for the UI\nconst totalDeps=((_response$data$depend2=response.data.dependencies)===null||_response$data$depend2===void 0?void 0:_response$data$depend2.length)||0;const processedDeps=((_response$data$depend3=response.data.dependencies)===null||_response$data$depend3===void 0?void 0:_response$data$depend3.filter(d=>d.vulnerableCount!==null).length)||0;const progressPercent=totalDeps>0?Math.round(processedDeps/totalDeps*100):0;// Update the analysis with the latest data\nconst totalVulnerabilities=response.data.dependencies?response.data.dependencies.reduce((total,dep)=>total+(dep.vulnerableCount||0),0):0;setAnalysis({...response.data,vulnerableCount:totalVulnerabilities,scanProgress:progressPercent,processedDependencies:processedDeps,totalDependencies:totalDeps,status:response.data.vulnerabilityCheckStatus==='IN_PROGRESS'?'in_progress':response.data.vulnerabilityCheckStatus==='COMPLETED'?'completed':response.data.vulnerabilityCheckStatus==='FAILED'?'failed':response.data.status||'completed'});if(response.data.dependencies){setDependencies(response.data.dependencies);}// If vulnerability checking is complete, stop polling\nif(response.data.vulnerabilityCheckStatus!=='IN_PROGRESS'){console.log(`Vulnerability check completed for analysis ID: ${analysisId}. Status: ${response.data.vulnerabilityCheckStatus}`);clearInterval(intervalId);setVulnerabilitiesLoading(false);// Show notification when status changes to completed\nsetSnackbar({open:true,message:`Analysis status updated: ${response.data.vulnerabilityCheckStatus==='COMPLETED'?'Completed':response.data.vulnerabilityCheckStatus}`,severity:response.data.vulnerabilityCheckStatus==='COMPLETED'?'success':'info'});// Force a refresh of the data to ensure we have the final state\nsetTimeout(async()=>{try{const finalResponse=await api.dependencyAnalysis.getById(analysisId);// Update one last time with complete data\nconst finalVulnerabilities=finalResponse.data.dependencies?finalResponse.data.dependencies.reduce((total,dep)=>total+(dep.vulnerableCount||0),0):0;setAnalysis({...finalResponse.data,vulnerableCount:finalVulnerabilities,status:finalResponse.data.vulnerabilityCheckStatus==='IN_PROGRESS'?'in_progress':finalResponse.data.vulnerabilityCheckStatus==='COMPLETED'?'completed':finalResponse.data.vulnerabilityCheckStatus==='FAILED'?'failed':finalResponse.data.status||'completed'});if(finalResponse.data.dependencies){setDependencies(finalResponse.data.dependencies);}console.log(`Final refresh completed for analysis ID: ${analysisId}`);// Success notification\nsetSnackbar({open:true,message:'Vulnerability scanning completed',severity:'success'});}catch(refreshError){console.error('Error refreshing final data:',refreshError);setSnackbar({open:true,message:'Error loading final vulnerability data. You can try refreshing manually.',severity:'warning'});}},1000);}}catch(pollingError){console.error('Error during polling interval:',pollingError);// Show a warning but don't stop polling yet\nsetSnackbar({open:true,message:'Error checking vulnerability status. Retrying...',severity:'warning'});}},3000);// Check every 3 seconds\n// Clean up the interval when the component unmounts\nreturn()=>{console.log(`Cleaning up polling interval for analysis ID: ${analysisId}`);clearInterval(intervalId);};}catch(error){console.error('Error setting up vulnerability polling:',error);setVulnerabilitiesLoading(false);setSnackbar({open:true,message:'Could not set up vulnerability status monitoring. Try refreshing the page.',severity:'error'});}};useEffect(()=>{// Log the ID to verify it's available\nconsole.log(\"Current analysis ID from params:\",analysisId);// Don't proceed if analysisId is undefined or null\nif(!analysisId){console.error(\"Analysis ID is missing from URL parameters\");setError(\"Missing analysis ID. Please select a valid analysis.\");setLoading(false);return;}// Fetch actual analysis data from the API\nconst fetchAnalysisData=async()=>{setLoading(true);try{// Get analysis details\nconsole.log(`Fetching analysis data for ID: ${analysisId}`);const response=await api.dependencyAnalysis.getById(analysisId);console.log('Analysis data received:',response.data);// Calculate total vulnerabilities for the header stats\nconst totalVulnerabilities=response.data.dependencies?response.data.dependencies.reduce((total,dep)=>total+(dep.vulnerableCount||0),0):0;// Combine the analysis data with calculated values\nsetAnalysis({...response.data,vulnerableCount:totalVulnerabilities,// Map the vulnerabilityCheckStatus to a UI-friendly status\nstatus:response.data.vulnerabilityCheckStatus==='IN_PROGRESS'?'in_progress':response.data.vulnerabilityCheckStatus==='COMPLETED'?'completed':response.data.vulnerabilityCheckStatus==='FAILED'?'failed':response.data.status||'completed'});// If the analysis contains dependencies, set them\nif(response.data.dependencies){setDependencies(response.data.dependencies);console.log(`Loaded ${response.data.dependencies.length} dependencies`);}else{console.log(\"No dependencies found in the response data\");}// If vulnerability checking is still in progress, start a polling mechanism\nif(response.data.vulnerabilityCheckStatus==='IN_PROGRESS'){pollForVulnerabilityUpdates();}else{setVulnerabilitiesLoading(false);}}catch(error){console.error('Error fetching analysis:',error);setError(`Failed to load analysis data: ${error.message||'Unknown error'}`);setSnackbar({open:true,message:`Error loading analysis: ${error.message||'Unknown error'}`,severity:'error'});// Set mock data for development/fallback\nconst mockAnalysis={id:parseInt(analysisId),projectId:1,projectName:'Error Loading Project',date:new Date().toISOString().split('T')[0],status:'error',totalDependencies:0,outdatedDependencies:0,vulnerabilities:0,licenseIssues:0};setAnalysis(mockAnalysis);setDependencies([]);setVulnerabilitiesLoading(false);}finally{setLoading(false);}};fetchAnalysisData();},[analysisId]);// Add a new effect to fetch charts when analysis loads or ID changes\nuseEffect(()=>{if(analysisId&&analysis!==null&&analysis!==void 0&&analysis.id){fetchCharts();}},[analysisId,analysis===null||analysis===void 0?void 0:analysis.id]);// Function to fetch chart data\nconst fetchCharts=async()=>{setChartsLoading(true);try{// Use the new chart data endpoints for the Nivo charts\nconst[dependencyStatusResponse,vulnerabilityStatusResponse,vulnerabilitySeverityResponse,licenseDistributionResponse]=await Promise.all([api.charts.getDependencyStatusData(analysisId),api.charts.getVulnerabilityStatusData(analysisId),api.charts.getVulnerabilitySeverityData(analysisId),api.charts.getLicenseDistributionData(analysisId)]);// Set the chart data from the responses\nsetCharts({dependencyUpdates:dependencyStatusResponse.data,// Data for the dependency status chart\nvulnerabilityStatus:vulnerabilityStatusResponse.data,// Data for the vulnerability status chart\nvulnerabilitySeverity:vulnerabilitySeverityResponse.data,// Data for the vulnerability severity chart\nlicenses:licenseDistributionResponse.data// Data for the license distribution chart\n});console.log('Chart data loaded successfully');}catch(error){console.error('Error fetching chart data:',error);// Fallback to using the analysis data directly\nsetCharts({dependencyUpdates:analysis,// Fallback to the analysis object for the dependency status chart\nvulnerabilityStatus:analysis,// Fallback to the analysis object for the vulnerability status chart\nvulnerabilitySeverity:analysis,// Fallback to the analysis object for the vulnerability severity chart\nlicenses:analysis// Fallback to the analysis object for the license distribution chart\n});// Show error notification\nsetSnackbar({open:true,message:'Error loading chart data. Using local data instead.',severity:'warning'});}finally{setChartsLoading(false);}};const handleTabChange=(event,newValue)=>{setTabValue(newValue);// Auto refresh vulnerability status when switching to the vulnerabilities tab\nif(newValue===3&&analysis&&analysis.vulnerabilityCheckStatus==='IN_PROGRESS'){console.log('Auto-refreshing vulnerability status when switching to vulnerabilities tab');refreshVulnerabilityStatus();}};// Filtering dependencies based on search query\nconst filteredDependencies=dependencies.filter(dep=>{const fullName=`${dep.groupId}:${dep.artifactId}:${dep.currentVersion}`.toLowerCase();return fullName.includes(searchQuery.toLowerCase());});// Collecting all vulnerabilities from dependencies for the vulnerabilities tab\nconst allVulnerabilities=React.useMemo(()=>{const vulnerabilities=[];dependencies.forEach(dep=>{if(dep.vulnerabilities&&dep.vulnerabilities.length>0){dep.vulnerabilities.forEach(vuln=>{vulnerabilities.push({...vuln,dependency:`${dep.groupId}:${dep.artifactId}:${dep.currentVersion}`});});}});return vulnerabilities;},[dependencies]);// Add a refresh function\nconst refreshVulnerabilityStatus=async()=>{try{var _response$data$depend4,_response$data$depend5;// Show loading state immediately for better UX\nsetSnackbar({open:true,message:'Refreshing vulnerability status...',severity:'info'});setVulnerabilitiesLoading(true);// Add a small delay to ensure the UI reflects the loading state\nawait new Promise(resolve=>setTimeout(resolve,300));// Fetch the latest analysis data\nconst response=await api.dependencyAnalysis.getById(analysisId);// Calculate the progress percentage for the UI\nconst totalDeps=((_response$data$depend4=response.data.dependencies)===null||_response$data$depend4===void 0?void 0:_response$data$depend4.length)||0;const processedDeps=((_response$data$depend5=response.data.dependencies)===null||_response$data$depend5===void 0?void 0:_response$data$depend5.filter(d=>d.vulnerableCount!==null).length)||0;const progressPercent=totalDeps>0?Math.round(processedDeps/totalDeps*100):0;// Update the analysis with the latest data\nconst totalVulnerabilities=response.data.dependencies?response.data.dependencies.reduce((total,dep)=>total+(dep.vulnerableCount||0),0):0;setAnalysis({...response.data,vulnerableCount:totalVulnerabilities,scanProgress:progressPercent,processedDependencies:processedDeps,totalDependencies:totalDeps,status:response.data.vulnerabilityCheckStatus==='IN_PROGRESS'?'in_progress':response.data.vulnerabilityCheckStatus==='COMPLETED'?'completed':response.data.vulnerabilityCheckStatus==='FAILED'?'failed':response.data.status||'completed'});if(response.data.dependencies){setDependencies(response.data.dependencies);}// Check if vulnerability processing is still in progress\nif(response.data.vulnerabilityCheckStatus==='IN_PROGRESS'){// Start polling if still in progress\npollForVulnerabilityUpdates();setSnackbar({open:true,message:`Vulnerability scan is ${progressPercent}% complete. Continuing to monitor progress.`,severity:'info'});}else{setVulnerabilitiesLoading(false);setSnackbar({open:true,message:'Vulnerability scan is complete!',severity:'success'});}}catch(error){console.error('Error refreshing vulnerability status:',error);// Provide specific error feedback based on the type of error\nlet errorMessage='Failed to refresh analysis data. Please try again.';if(error.response){if(error.response.status===404){errorMessage='Analysis not found. It may have been deleted.';}else if(error.response.data&&error.response.data.message){errorMessage=error.response.data.message;}}else if(error.request){errorMessage='Server not responding. Please check your connection.';}setSnackbar({open:true,message:errorMessage,severity:'error'});// Still stop the loading state even on error\nsetVulnerabilitiesLoading(false);}};const handleCloseSnackbar=()=>{setSnackbar({...snackbar,open:false});};if(loading){return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',mt:10},children:/*#__PURE__*/_jsx(CircularProgress,{})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:3},children:[/*#__PURE__*/_jsx(IconButton,{onClick:()=>navigate(-1),sx:{mr:1},children:/*#__PURE__*/_jsx(ArrowBackIcon,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",sx:{flexGrow:1},children:\"Analysis Details\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(DownloadIcon,{}),sx:{mr:1},children:\"Export\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(ShareIcon,{}),children:\"Share\"})]}),/*#__PURE__*/_jsx(Paper,{sx:{p:3,mb:4},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:8,children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"Project: \",analysis.projectName]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"Analysis completed on \",analysis.date]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,sx:{display:'flex',justifyContent:{xs:'flex-start',md:'flex-end'}},children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Chip,{label:analysis.vulnerabilityCheckStatus==='IN_PROGRESS'?'In Progress':analysis.status==='completed'||analysis.status==='COMPLETED'?'Completed':analysis.status==='failed'||analysis.status==='FAILED'?'Failed':analysis.status==='in_progress'||analysis.status==='IN_PROGRESS'?'In Progress':'In Progress',color:analysis.vulnerabilityCheckStatus==='IN_PROGRESS'?'primary':analysis.status==='completed'||analysis.status==='COMPLETED'?'success':analysis.status==='failed'||analysis.status==='FAILED'?'error':analysis.status==='in_progress'||analysis.status==='IN_PROGRESS'?'primary':'primary',sx:{mb:1}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"ID: \",analysis.id]})]})})]})}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mb:4},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(33, 150, 243, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"Total Dependencies\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1},children:analysis.totalDependencies})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(255, 152, 0, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"Outdated\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1,color:'warning.main'},children:analysis.outdatedDependencies})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(239, 83, 80, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"Vulnerabilities\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1,color:'error.main'},children:analysis.vulnerableCount||0})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,sm:3,children:/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',flexDirection:'column',bgcolor:'rgba(156, 39, 176, 0.1)',borderRadius:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",variant:\"body2\",children:\"License Issues\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mt:1,color:'#9c27b0'},children:analysis.licenseIssues})]})})]}),/*#__PURE__*/_jsxs(Paper,{sx:{mb:4},children:[/*#__PURE__*/_jsx(Box,{sx:{borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsxs(Tabs,{value:tabValue,onChange:handleTabChange,\"aria-label\":\"analysis tabs\",variant:\"scrollable\",scrollButtons:\"auto\",children:[/*#__PURE__*/_jsx(Tab,{label:\"Overview\"}),/*#__PURE__*/_jsx(Tab,{label:\"Dependencies\"}),/*#__PURE__*/_jsx(Tab,{label:\"Charts\"}),/*#__PURE__*/_jsx(Tab,{label:\"Vulnerabilities\"}),/*#__PURE__*/_jsx(Tab,{label:\"Licenses\"})]})}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:0,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Analysis Overview\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{mb:3},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"Dependency Status\"}),chartsLoading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:3,height:250},children:/*#__PURE__*/_jsx(CircularProgress,{})}):charts.dependencyUpdates?/*#__PURE__*/_jsx(Box,{sx:{height:300},children:/*#__PURE__*/_jsx(DependencyStatusChart,{data:charts.dependencyUpdates,loading:chartsLoading,height:300})}):/*#__PURE__*/_jsx(Box,{sx:{height:250,bgcolor:'rgba(33, 150, 243, 0.1)',borderRadius:1,display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column',p:2},children:/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",children:\"No chart available\"})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"Security Overview\"}),chartsLoading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:3,height:250},children:/*#__PURE__*/_jsx(CircularProgress,{})}):charts.vulnerabilityStatus?/*#__PURE__*/_jsx(Box,{sx:{height:300},children:/*#__PURE__*/_jsx(VulnerabilityChart,{data:charts.vulnerabilityStatus,loading:chartsLoading,height:300})}):/*#__PURE__*/_jsx(Box,{sx:{height:250,bgcolor:'rgba(244, 67, 54, 0.1)',borderRadius:1,display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column',p:2},children:/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",children:\"No chart available\"})})]})})})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"Vulnerability Severity\"}),chartsLoading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:3,height:250},children:/*#__PURE__*/_jsx(CircularProgress,{})}):charts.vulnerabilitySeverity?/*#__PURE__*/_jsx(Box,{sx:{height:300},children:/*#__PURE__*/_jsx(VulnerabilitySeverityChart,{data:charts.vulnerabilitySeverity,loading:chartsLoading,height:300})}):/*#__PURE__*/_jsx(Box,{sx:{height:250,bgcolor:'rgba(244, 67, 54, 0.1)',borderRadius:1,display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column',p:2},children:/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",children:\"No severity data available\"})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"License Distribution\"}),chartsLoading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:3,height:250},children:/*#__PURE__*/_jsx(CircularProgress,{})}):charts.licenses?/*#__PURE__*/_jsx(Box,{sx:{height:300},children:/*#__PURE__*/_jsx(LicenseDistributionChart,{data:charts.licenses,loading:chartsLoading,height:300})}):/*#__PURE__*/_jsx(Box,{sx:{height:250,bgcolor:'rgba(76, 175, 80, 0.1)',borderRadius:1,display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column',p:2},children:/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",children:\"No license data available\"})})]})})})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,sx:{mt:4},children:\"Summary\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",paragraph:true,children:[\"This analysis found \",analysis.outdatedDependencies,\" outdated dependencies, \",analysis.vulnerableCount||0,\" security vulnerabilities, and \",analysis.licenseIssues,\" license compliance issues.\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",paragraph:true,children:\"It's recommended to update the dependencies to their latest versions to resolve security issues and take advantage of the latest features and bug fixes.\"}),/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",children:\"Generate Full Report\"})})]}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:1,children:[/*#__PURE__*/_jsx(Box,{sx:{mb:3},children:/*#__PURE__*/_jsx(TextField,{placeholder:\"Search dependencies...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),size:\"small\",sx:{width:'40%'},InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(SearchIcon,{})})}})}),/*#__PURE__*/_jsx(TableContainer,{component:Paper,variant:\"outlined\",children:/*#__PURE__*/_jsxs(Table,{size:\"small\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Group ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Artifact ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Current Version\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Latest Version\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Scope\"}),/*#__PURE__*/_jsx(TableCell,{children:\"License\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"})]})}),/*#__PURE__*/_jsxs(TableBody,{children:[filteredDependencies.map(dependency=>/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:dependency.groupId}),/*#__PURE__*/_jsx(TableCell,{children:dependency.artifactId}),/*#__PURE__*/_jsx(TableCell,{children:dependency.currentVersion}),/*#__PURE__*/_jsx(TableCell,{children:dependency.latestVersion?dependency.isOutdated?/*#__PURE__*/_jsxs(Typography,{color:\"warning.main\",fontWeight:\"medium\",children:[dependency.latestVersion,\" (\",dependency.versionsBehind,\" versions behind)\"]}):dependency.latestVersion:/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",fontStyle:\"italic\",children:\"Unknown\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:dependency.scope||'compile',size:\"small\",color:dependency.scope==='test'?'secondary':dependency.scope==='provided'?'info':'default',variant:\"outlined\",sx:{fontWeight:'normal'}})}),/*#__PURE__*/_jsx(TableCell,{children:dependency.license||'Unknown'}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:dependency.status||(dependency.isVulnerable?'Vulnerable':dependency.isOutdated?'Outdated':dependency.latestVersion?'Up-to-date':'Unknown'),size:\"small\",color:dependency.status==='Vulnerable'||dependency.isVulnerable?'error':dependency.status==='Outdated'||dependency.isOutdated?'warning':dependency.status==='Up-to-date'?'success':'default'})})]},dependency.id)),filteredDependencies.length===0&&/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:7,align:\"center\",children:\"No dependencies found\"})})]})]})})]}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:2,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Visualization Charts\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"Dependency Update Status\"}),/*#__PURE__*/_jsx(Box,{sx:{height:400},children:/*#__PURE__*/_jsx(DependencyStatusChart,{data:charts.dependencyUpdates||analysis,loading:chartsLoading,height:400})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"Vulnerability Status\"}),/*#__PURE__*/_jsx(Box,{sx:{height:400},children:/*#__PURE__*/_jsx(VulnerabilityChart,{data:charts.vulnerabilityStatus||analysis,loading:chartsLoading,height:400})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"Vulnerability Severity\"}),/*#__PURE__*/_jsx(Box,{sx:{height:400},children:/*#__PURE__*/_jsx(VulnerabilitySeverityChart,{data:charts.vulnerabilitySeverity||analysis,loading:chartsLoading,height:400})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"License Distribution\"}),/*#__PURE__*/_jsx(Box,{sx:{height:400},children:/*#__PURE__*/_jsx(LicenseDistributionChart,{data:charts.licenses||analysis,loading:chartsLoading,height:400})})]})})})]})]}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:3,children:vulnerabilitiesLoading?/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',py:6},children:[/*#__PURE__*/_jsx(CircularProgress,{size:40,sx:{mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"Scanning for vulnerabilities...\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:1,mb:3},children:\"Security scanning is running in the background. You can navigate away from this page and come back later to see the results. Basic dependency information is already available in the Dependencies tab.\"}),analysis&&analysis.vulnerabilityCheckStatus==='IN_PROGRESS'&&/*#__PURE__*/_jsxs(Box,{sx:{mt:3,width:'100%',maxWidth:500,mx:'auto'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Scanning dependencies...\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"primary\",children:[analysis.processedDependencies||dependencies.filter(d=>d.vulnerableCount!==null).length,\" / \",analysis.totalDependencies||dependencies.length,\" checked\"]})]}),/*#__PURE__*/_jsx(Box,{sx:{width:'100%',bgcolor:'background.paper',borderRadius:1,p:1},children:/*#__PURE__*/_jsx(Box,{sx:{height:8,width:`${analysis.scanProgress||dependencies.filter(d=>d.vulnerableCount!==null).length/dependencies.length*100}%`,bgcolor:'primary.main',borderRadius:5,transition:'width 0.5s ease-in-out'}})}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",align:\"center\",sx:{display:'block',mt:1},children:analysis.scanProgress?`${analysis.scanProgress}% complete`:'Initializing scan...'}),/*#__PURE__*/_jsx(Box,{sx:{mt:4,display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:refreshVulnerabilityStatus,startIcon:/*#__PURE__*/_jsx(UpdateIcon,{}),children:\"Refresh Status\"})}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:2,textAlign:'center',fontStyle:'italic'},children:\"Tip: This process runs in the background and the page will update automatically when completed.\"})]})]}):allVulnerabilities.length>0?/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Dependency\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Vulnerability\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Severity\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Description\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Affected Versions\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Fixed In\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:allVulnerabilities.map((vuln,index)=>/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:vuln.dependency}),/*#__PURE__*/_jsx(TableCell,{children:vuln.name}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:vuln.severity,color:vuln.severity==='CRITICAL'?'error':vuln.severity==='HIGH'?'error':vuln.severity==='MEDIUM'?'warning':'info',size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:vuln.description}),/*#__PURE__*/_jsx(TableCell,{children:vuln.affectedVersions}),/*#__PURE__*/_jsx(TableCell,{children:vuln.fixedInVersion})]},`${vuln.id||index}`))})]})}):/*#__PURE__*/_jsxs(Box,{sx:{p:4,textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"No vulnerabilities found\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:1},children:\"All dependencies appear to be secure. Continue to monitor for new vulnerabilities.\"})]})}),/*#__PURE__*/_jsxs(TabPanel,{value:tabValue,index:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"License Compliance\"}),analysis.licenseIssues>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",paragraph:true,children:\"The following dependencies have license issues that may need attention:\"}),/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Dependency\"}),/*#__PURE__*/_jsx(TableCell,{children:\"License\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Issue\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Recommendation\"})]})}),/*#__PURE__*/_jsxs(TableBody,{children:[/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:\"mysql:mysql-connector-java:8.0.28\"}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:\"GPL\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:\"GPL is copyleft license and may be incompatible with commercial use\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Consider using a commercial license or alternative database connector\"})]}),/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:\"unknown:library:1.0.0\"}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:\"Unknown\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:\"No license information available\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Verify license information with the library author\"})]})]})]})})]}):/*#__PURE__*/_jsxs(Box,{sx:{p:4,textAlign:'center'},children:[/*#__PURE__*/_jsx(CheckCircleIcon,{color:\"success\",sx:{fontSize:48,mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"No license issues found\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"All your dependencies have compatible licenses.\"})]})]})]}),/*#__PURE__*/_jsx(Snackbar,{open:snackbar.open,autoHideDuration:5000,onClose:handleCloseSnackbar,anchorOrigin:{vertical:'bottom',horizontal:'right'},children:/*#__PURE__*/_jsx(Alert,{onClose:handleCloseSnackbar,severity:snackbar.severity,sx:{width:'100%'},children:snackbar.message})})]});};export default AnalysisDetail;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}